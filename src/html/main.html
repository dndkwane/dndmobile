<!DOCTYPE html>
<html lang="en">
@@include('./include/head.html')
<body>
    <div class="wrap main">

        @@include('./include/header.html')

        <section class="main-indicator-wrap">
            <div>
                <a href="#one" class="active">
                    <span></span>
                    <em>KB국민은행</em>
                </a>
            </div>
            <div>
                <a href="#two" class="indi-white">
                    <span></span>
                    <em>SC제일은행</em>
                </a>
            </div>
            <div>
                <a href="#three" class="cj-white">
                    <span></span>
                    <em>CJ대한통운</em>
                </a>
            </div>
            <div>
                <a href="#four" class="indi-white">
                    <span></span>
                    <em>우리은행</em>
                </a>
            </div>
            <div>
                <a href="#five">
                    <span></span>
                    <em>우리은행</em>
                </a>
            </div>
            <div>
                <a href="#six">
                    <span></span>
                    <em>우리은행</em>
                </a>
            </div>
        </section>

        <section class="panel" id="one">
            @@include('./project_kb.html')
        </section>
        <section class="panel" id="two">
            @@include('./project_sc.html')
        </section>
        <section class="panel" id="three">
            @@include('./project_cj.html')
        </section>
        <section class="panel" id="four">
            @@include('./project_wooriopen.html')
        </section>
        <section class="panel" id="five">
            @@include('./project_woorimy.html')
        </section>
        <section class="panel" id="six">
            @@include('./project_wooricerti.html')
        </section>
        @@include('./include/footer.html')
    </div>
</body>

<script>
    gsap.registerPlugin(ScrollTrigger, ScrollToPlugin);
    let links = gsap.utils.toArray(".main-indicator-wrap a");
    links.forEach(a => {
        let element = document.querySelector(a.getAttribute("href")),
            linkST = ScrollTrigger.create({
                trigger: element,
                start: "top top"
            });
        ScrollTrigger.create({
            trigger: element,
            start: "top center",
            end: "bottom center",
            onToggle: self => self.isActive && setActive(a)
        });
        a.addEventListener("click", e => {
            e.preventDefault();
            gsap.to(window, { duration: 1, scrollTo: linkST.start, overwrite: "auto" });
        });
    });

    function setActive(link) {
        links.forEach(el => el.classList.remove("active"));
        link.classList.add("active");

        if (link.classList.contains("indi-white")) {
            document.querySelector(".main-indicator-wrap").classList.add('white')
            document.querySelector(".menu-toggle").classList.add('white')
            document.querySelector("html").classList.add('bg-black')
        } else {
            document.querySelector(".main-indicator-wrap").classList.remove('white')
            document.querySelector(".menu-toggle").classList.remove('white')
            document.querySelector("html").classList.remove('bg-black')
        }
    }

    //responsive
    let mm = gsap.matchMedia();
    mm.add("(min-width: 800px)", () => {
        let panels = gsap.utils.toArray(".main .panel");
        panels.forEach((panel, i) => {
            ScrollTrigger.create({
                trigger: panel,
                start: "top center",
                end: "bottom bottom",
                // end: () => "+=" + panel.offsetHeight,
                scrub: true,
                // markers: true,
                onEnter: () => {
                    panels.forEach((e) => {
                        e.classList.remove("active");
                    });
                    panels[i].classList.add("active");
                },
                onEnterBack: () => {
                    panels.forEach((e) => {
                        e.classList.remove("active");
                    });
                    panels[i].classList.add("active");
                }
            });
        });
    });
</script>

</html>